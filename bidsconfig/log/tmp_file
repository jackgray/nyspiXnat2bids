
<!DOCTYPE html>
<!--[if lt IE 9]><html class="ie ie8 ltie9 ltie10"><![endif]-->
<!--[if IE 9]><html class="ie ie9 ltie10"><![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>

    <!-- start xnat-templates/navigations/htmlOpen -->

    
        
    <title>XNATnyspi</title>
    <!-- HeaderIncludes -->
    








<!-- path: /xnat-templates/navigations/HeaderIncludes -->

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="cache-control" content="max-age=0">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="-1">
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT">



<!-- START BaseJS.vm -->




    <!-- load polyfills before ANY other JavaScript -->
    <script src="/scripts/polyfills.js"></script>

    <!-- XNAT global functions (no dependencies) -->
    <script src="/scripts/globals.js"></script>

    <!-- set global vars that are used often -->
    <script>

        var XNAT = XNAT || {};
        var serverRoot = '';
        var csrfToken = 'ce758b23-a810-4592-aba2-0ea568f08e47';
        var showReason = realValue('false');
        var requireReason = realValue('false');

    </script>
    
    <!-- set theme js vars -->
    
    <!-- required libraries -->
    <script src="/scripts/lib/loadjs/loadjs.js"></script>
    <script src="/scripts/lib/jquery/jquery.min.js"></script>
    <script src="/scripts/lib/jquery/jquery-migrate.min.js"></script>
    <script>
        // alias jQuery to jq
        var jq = jQuery;
    </script>

    <!-- jQuery plugins -->
    <link rel="stylesheet" type="text/css" href="/scripts/lib/jquery-plugins/chosen/chosen.min.css?v=1.7.3c">
    <script src="/scripts/lib/jquery-plugins/chosen/chosen.jquery.min.js"></script>
    <script src="/scripts/lib/jquery-plugins/jquery.maskedinput.min.js"></script>
    <script src="/scripts/lib/jquery-plugins/jquery.hasClasses.js"></script>
    <script src="/scripts/lib/jquery-plugins/jquery.dataAttr.js"></script>
    <script src="/scripts/lib/jquery-plugins/jquery.form.js"></script>

    <!-- other libraries -->
    <script src="/scripts/lib/spawn/spawn.js"></script>
    <script src="/scripts/lib/js.cookie.js"></script>
    <script src="/scripts/lib/yamljs/dist/yaml.js"></script>
    <script src="/scripts/lib/form2js/src/form2js.js"></script>
    <script src="/scripts/lib/ace/ace.js"></script>

    <!-- XNAT utility functions -->
    <script src="/scripts/utils.js"></script>

    

<!-- END BaseJS.vm -->



<script>

    /*
     * XNAT global namespace object, which will not be overwriten if
     * already defined. Also define some other top level namespaces.
     */
    extend(XNAT, {
        /*
         * Parent namespace that templates can use to put their
         * own namespace
         */
        app: {
            displayNames: {
                singular: {
                    project: "Project",
                    subject: "Subject",
                    imageSession: "Session",
                    mrSession: "MR Session"
                },
                plural: {
                    project: "Projects",
                    subject: "Subjects",
                    imageSession: "Sessions",
                    mrSession: "MR Sessions"
                }
            },
            siteId: "XNATnyspi"
        },
        data: {
            context: {
                                                                siteName: "XNATnyspi",
                projectName: "OPTIMUM",
                                    projectID: "roosopt",
                    project: "roosopt",
                                xsiType: "xnat:projectData",
                                    isSubject: false,
                    isExperiment: false,
                    isSubjectAssessor: false,
                    isImageSession: false,
                    isImageAssessor: false,
                                                                                            subjectLabel: "",
                subjectID: "",
                label: "roosopt",
                ID: "roosopt"
                        },
            timestamp: jq.now() // timestamp for the page when it loads
        }
    });

    if (XNAT.data.context.projectName === "") {
                XNAT.data.context.projectName = "OPTIMUM";
    }

    // 'page' object is same as 'context' - easier to remember?
    XNAT.data.page = XNAT.data.context;

    XNAT.app.showLeftBar = realValue(true);
    XNAT.app.showLeftBarProjects = realValue(true);
    XNAT.app.showLeftBarFavorites = realValue(true);
    XNAT.app.showLeftBarSearch =  realValue(true);
    XNAT.app.showLeftBarBrowse = realValue(true);

    window.available_elements = [];

            
                window.available_elements.push({
            singular: "Subject",
            plural: "Subjects",
            element_name: "xnat:subjectData",
            actions: [],
            "lbg": "FFFFFF",
            "dbg": "DEDEDE",
            "isExperiment": false,
            "isSubjectAssessor": false,
            "isImageAssessor": false,
            "isImageSession": false,
            "isImageScan": false
        });
                window.available_elements.push({
            singular: "MR Session",
            plural: "MR Sessions",
            element_name: "xnat:mrSessionData",
            actions: [],
            "lbg": "FFFFFF",
            "dbg": "DEDEDE",
            "isExperiment": true,
            "isSubjectAssessor": true,
            "isImageAssessor": false,
            "isImageSession": true,
            "isImageScan": false
        });
        
    window.available_elements.getByName = function (name) {
        for (var aeC = 0; aeC < this.length; aeC++) {
            if (this[aeC].element_name == name) {
                return this[aeC];
            }
        }
        // return empty object if not found
        return {}
    };

                                window.projectScope = "roosopt";
                    
                                  XNAT.app.current_uri=serverRoot+"/REST/projects/roosopt/subjects/$om.getSubjectId()/experiments/roosopt";
                    
    // quickly reference today's date
    XNAT.data.todaysDate = {};
    // if today was January 23, 2013...
    // m (1), mm (01), d (23), dd (23), yyyy (2013), ISO/iso (2013-01-23), US/us (01/23/2013)
    (function (dateObj) {
        dateObj.date = new Date();
        dateObj.gotMonth = dateObj.date.getMonth();
        dateObj.m = (dateObj.gotMonth + 1).toString();
        dateObj.mm = (dateObj.m.length === 1) ? '0' + dateObj.m : dateObj.m;
        dateObj.d = dateObj.date.getDate().toString();
        dateObj.dd = (dateObj.d.length === 1) ? '0' + dateObj.d : dateObj.d;
        dateObj.yyyy = dateObj.date.getFullYear().toString();
        dateObj.ISO = dateObj.iso = dateObj.yyyy + '-' + dateObj.mm + '-' + dateObj.dd;
        dateObj.US = dateObj.us = dateObj.mm + '/' + dateObj.dd + '/' + dateObj.yyyy;
    })(XNAT.data.todaysDate);

</script>
<script>
    // initialize "Chosen" menus on DOM load
    // all <select class="xnat-menu"> elements
    // will be converted
    // putting this here to be at the top of
    // the jQuery DOM-ready queue
    jq(function(){menuInit()});
</script>
<script src="/scripts/xdat.js"></script>
<script src="/scripts/DynamicJSLoad.js"></script>

<!-- YAHOO USER INTERFACE files below here -->
<script src="/scripts/yui/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script src="/scripts/yui/build/event/event-min.js"></script>
<script src="/scripts/yui/build/container/container-min.js"></script>
<script src="/scripts/yui/build/menu/menu-min.js"></script>
<script src="/scripts/yui/build/element/element-beta-min.js"></script>
<script src="/scripts/yui/build/button/button-min.js"></script>
<script src="/scripts/yui/build/connection/connection-min.js"></script>
<script src="/scripts/yui/build/treeview/treeview-min.js"></script>
<script src="/scripts/yui/build/cookie/cookie-min.js"></script>
<script src="/scripts/yui/build/tabview/tabview-min.js"></script>
<script src="/scripts/yui/build/datasource/datasource-min.js"></script>
<script src="/scripts/yui/build/resize/resize-min.js"></script>
<script src="/scripts/yui/build/dragdrop/dragdrop-min.js"></script>
<script src="/scripts/yui/build/datatable/datatable-min.js"></script>
<script src="/scripts/yui/build/paginator/paginator-min.js"></script>
<script src="/scripts/yui/build/json/json-min.js"></script>
<script src="/scripts/yui/xnat_loader.js"></script>
<script src="/scripts/LeftBarTreeView.js"></script>
<script src="/scripts/justification/justification.js"></script>
<script>

    // The YUIDOM alias is used throughout XNAT
    var YUIDOM = YAHOO.util.Dom;

    XNAT.app = getObject(XNAT.app||{});
    XNAT.app.addFormCSRF = function(form){
        $$(form||'form').each(function(){
            var form$ = $(this);
            if (!form$.has('input[name="XNAT_CSRF"]').length){
                form$.append('<input type="hidden" name="XNAT_CSRF" value="' + csrfToken + '">')
            }
        });
    };

    jq(function(){
        // add hidden input with CSRF data
        // to all forms on page load
        XNAT.app.addFormCSRF();
    });

</script>

<!-- YUI css -->
<link rel="stylesheet" type="text/css" href="/scripts/yui/build/assets/skins/xnat/xnat.css?v=1.7.3c">

<!-- date input stuff -->
<link rel="stylesheet" type="text/css" href="/scripts/lib/dateTimePicker/jquery.datetimepicker.min.css?v=1.7.3c">
<script src="/scripts/lib/dateTimePicker/jquery.datetimepicker.full.min.js"></script>

<link rel="stylesheet" type="text/css" href="/scripts/yui/build/calendar/assets/skins/sam/calendar.css?v=1.7.3c">
<script src="/scripts/yui/build/calendar/calendar-min.js"></script>
<script src="/scripts/ezCalendar.js"></script>



<!-- START AppJS.vm -->




    <!-- app.css loaded first -->
    <link rel="stylesheet" type="text/css" href="/style/app.css?v=1.7.3c">

    <!-- Icon sets -->
    <link rel="stylesheet" type="text/css" href="/style/font-awesome.min.css?v=1.7.3c">
    <link rel="stylesheet" type="text/css" href="/style/icons.css?v=1.7.3c">
    <link rel="stylesheet" type="text/css" href="/page/admin/style.css?v=1.7.3c">

    <link rel="stylesheet" type="text/css" href="/scripts/xmodal-v1/xmodal.css?v=1.7.3c">
    <script src="/scripts/xmodal-v1/xmodal.js"></script>
    <script src="/scripts/xmodal-v1/xmodal-migrate.js"></script>

    
    <!-- XNAT JLAPI stylesheets -->
    <link rel="stylesheet" type="text/css" href="/scripts/xnat/ui/dialog.css?v=1.7.3c">

    <!-- XNAT JLAPI scripts -->
    <script src="/scripts/xnat/util/sub64.js"></script>
    <script src="/scripts/xnat/validate.js"></script>
    <script src="/scripts/xnat/url.js"></script>
    <script src="/scripts/xnat/xhr.js"></script>
    <script src="/scripts/xnat/cookie.js"></script>
    <script src="/scripts/xnat/event.js"></script>
    <script src="/scripts/xnat/element.js"></script>
    <script src="/scripts/xnat/ui/templates.js"></script>
    <script src="/scripts/xnat/ui/input.js"></script>
    <script src="/scripts/xnat/ui/select.js"></script>
    <script src="/scripts/xnat/ui/table.js"></script>
    <script src="/scripts/xnat/ui/panel.js"></script>
    <script src="/scripts/xnat/ui/tabs.js"></script>
    <script src="/scripts/xnat/ui/banner.js"></script>
    <script src="/scripts/xnat/ui/popup.js"></script>
    <script src="/scripts/xnat/ui/dialog.js"></script>

    <!-- The Spawner! -->
    <script src="/scripts/xnat/spawner.js"></script>

    <!-- XNAT app scripts -->
    <script src="/scripts/xnat/app/codeEditor.js"></script>
    <script src="/scripts/xnat/app/pluginSettings.js"></script>

    
    <!-- JS functions to initialize XNAT -->
    <script src="/scripts/xnat/init.js"></script>

    

<!-- END AppJS.vm -->




<link rel="stylesheet" type="text/css" href="/scripts/tabWrangler/tabWrangler.css?v=1.7.3c">
<script src="/scripts/tabWrangler/tabWrangler.js"></script>


		
    <!-- /HeaderIncludes -->

    <!-- end xnat-templates/navigations/htmlOpen -->


<!-- path: xnat-templates/navigations/bodyOpen -->
</head>
<body id="page_body" class="xnat yui-skin-sam">



<!-- path: xdat-templates/layouts/Default -->

            


<!-- START: xnat-templates/navigations/DefaultTop.vm -->




<style type="text/css">

    #attention_icon { float: left ; padding-top: 7px ; padding-left: 11px ; }
    #attention_icon:hover { cursor: pointer ; }

    #main_nav ul.nav .dark-shadow {
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.8);
    }

    #main_nav ul.nav div.data-table-wrapper {
        width: auto;
        min-width: 200px;
        max-width: 880px;
        max-height: 525px;
        /*box-sizing: border-box;*/
        overflow-y: auto;
        overflow-x: hidden;
        border: none;
    }

    #main_nav ul.nav div.data-table-wrapper * {
        /*box-sizing: border-box;*/
    }

    #main_nav ul.nav #browse-projects div.data-table-wrapper {
        /*width: 880px;*/
        overflow-y: scroll;
    }

    #main_nav ul.nav table.data-table {
        padding: 0;
        border: none;
    }

    #main_nav ul.nav table.data-table th,
    #main_nav ul.nav table.data-table td {
        padding: 2px 12px;
        border: none;
    }

    #main_nav ul.nav table.data-table th {
        text-align: left;
        padding: 4px 12px;
        /*font-weight: bold;*/
        /*border-right: 1px solid #ccc;*/
    }
    #main_nav ul.nav table.data-table th:last-of-type {
        /*border-right: none;*/
    }
    #main_nav ul.nav table.data-table tr:hover,
    #main_nav ul.nav table.data-table .item:hover {
        background: #e5f2ff;
    }
    #main_nav ul.nav table.data-table th.sort {
        background: none;
        border-bottom: 1px solid #d0d0d0;
        text-align: left;
    }
    #main_nav ul.nav table.data-table td.filter {
        background: #f0f0f0;
        padding: 6px;
        border-bottom: 1px solid #d0d0d0;
    }
    #main_nav ul.nav table.data-table td.filter > input {
        width: 100%;
        box-sizing: border-box;
    }
    #main_nav ul.nav table.data-table td a {
        padding: 0;
        font-size: 12px;
    }
    #main_nav ul.nav table.data-table td a.truncate {
        width: 100%;
        max-width: 600px;
    }


</style>

<div id="user_bar">
    <div class="inner">
        <img id="attention_icon" src="/images/attention.png" style="display:none;" alt="attention needed - click for more info" title="attention needed - click for more info">
                                                            <span id="user_info">Logged in as: &nbsp;<a id="username-link" href="/app/template/XDATScreen_UpdateUser.vm">grayjoh</a> <b>|</b><span class="tip_icon" style="margin-right:3px;">
                    <span class="tip shadowed" style="top:20px;z-index:10000;white-space:normal;left:-150px;width:300px;background-color:#ffc;">Your XNAT session will auto-logout after a certain period of inactivity. You can reset that timer without reloading the page by clicking "renew."</span>
                </span>
                                Auto-logout in: <b id="timeLeft">-:--:--</b> - <a id="timeLeftRenew" href="javascript:" onClick="XNAT.app.timeout.handleOk()">renew</a> <b>|</b> <a id="logout_user" href="/app/action/LogoutUser">Logout</a></span>
                <script type="text/javascript">
                    window.username = 'grayjoh';
                    XNAT.cookie.set('guest', 'false');
                </script>
                            <div class="clear"></div>

        
                        </div>
</div><!-- /user_bar -->

<script type="text/javascript">
    jq(function(){
        if (XNAT.cookie.get('WARNING_BAR') == 'CLOSED'){
            jq('#attention_icon').show();
        }
        else {
            jq('#warning_bar').show();
        }
        jq('#attention_icon').click(function(){
            jq('#warning_bar').slideToggle(200);
        });
        jq('#warning_bar .close').click(function(){
            XNAT.cookie.set('WARNING_BAR', 'CLOSED');
            jq('#warning_bar').slideUp(200);
        });
    })
</script>

<div id="main-nav-backdrop"></div>

<div id="main_nav">
    <div class="inner">

    <ul class="nav">
        								<!-- Sequence: 10 -->
<!-- allowGuest: true -->
<li id="main-nav-home">
    <a id="nav-home" title="Home" href="/app/template/Index.vm">&nbsp;</a>
    <script>
        $('#nav-home').css({
            width: '30px',
            backgroundImage: "url('/images/xnat-nav-logo-white-lg.png')",
            backgroundRepeat: 'no-repeat',
            backgroundSize: '32px',
            backgroundPosition: 'center'
        });
    </script>
</li>
									<!-- Sequence: 11 -->
<!-- allowGuest: true -->

<li class="hidden"><a href="#browse">Browse</a>
    <ul style="min-width: 120px">
        								<!-- Sequence: 10 -->
<!-- allowGuest: true -->









<!-- Browse/Default -->
<li class="hidden"><a href="#!" class="nolink">My Projects</a>
    <ul id="my-projects" class="shadowed dark-shadow">
        <!-- Sequence: 10 -->
    </ul>
</li>
<li class="hidden"><a id="browse-projects-menu-item" href="#!" class="nolink">All Projects</a>
    <ul id="browse-projects" class="shadowed dark-shadow">
        <!-- Sequence: 11 -->
                    <li class="create-project hidden"><a href="/app/template/XDATScreen_add_xnat_projectData.vm">Create Project</a></li>
            </ul>
</li>
<li class="hidden"><a href="#!" class="nolink">Favorite Projects</a>
    <ul id="favorite-projects">
        <!-- Sequence: 20 -->
    </ul>
</li>
<li class="hidden"><a href="#!" class="nolink">Data</a>
    <ul id="browse-data">
        <!-- Sequence: 30 -->
    </ul>
</li>

<script src="/scripts/xnat/app/topnav-browse.js"></script>
			    </ul>
</li>
									<!-- Sequence: 20 -->

<li><a href="#new">New</a>
    <ul>
        								









<!-- Sequence: 10 -->
    <li><a href="/app/template/XDATScreen_add_xnat_projectData.vm">Project</a></li>
<!-- -->
                                    
            <li><a href="/app/template/XDATScreen_add_experiment.vm/project/roosopt">Experiment</a></li>
    <!-- -->
			    </ul>
</li>
									<!-- Sequence: 30 -->
<li><a href="#upload">Upload</a>
    <ul>
        								<!-- Sequence: 10 -->
<!-- Upload/Default -->
    <li><a href="#!" class="nolink">Images</a>
        <ul>
            <!-- Sequence: 10 -->
            <!-- Images -->
            <li><a href="/app/template/UploadOptions.vm">All Upload Options</a>
            <li><a href="/app/template/UploadAssistantPage.vm">Upload Assistant</a></li>
            <li><a href="/app/template/CompressedUploaderPage.vm">Compressed Uploader</a></li>
            <li><a href="/app/template/DICOMSCPPage.vm">DICOM SCP</a></li>
        </ul>
    </li>
    <li><a href="/app/template/XMLUpload.vm">XML</a></li>
    <li><a href="/app/template/XDATScreen_uploadCSV.vm">Spreadsheet</a></li>
    <li><a href="/app/template/XDATScreen_prearchives.vm">Go to prearchive</a></li>
			    </ul>
</li>
									<!-- Sequence: 40 -->
									<!-- Title: Tools -->
<!-- Sequence: 50 -->
<!-- allowGuest: true -->

<li><a href="#tools">Tools</a>
    <ul>
        								<!-- Sequence: 10 -->
<!-- allowGuest: true -->
<li><a href="https://wiki.xnat.org/xnat-tools" target="_blank">XNAT Tools</a></li>
<li><a href="https://wiki.xnat.org/xnat-tools/dicombrowser" target="_blank">DICOM Browser</a></li>
<li><a href="https://wiki.xnat.org/xnat-tools/xnat-web-services-client-tools" target="_blank">Command Prompt Tools</a></li>
			    </ul>
</li>
									<!-- Sequence: 60 -->
<li><a href="#help">Help</a>
    <ul>
        								<!-- Sequence: 10 -->
<!-- Home/Default -->
    <li><a href="/app/template/ReportIssue.vm">Report a Problem</a></li>
    <li><a href="http://wiki.xnat.org" target="_blank">Documentation</a></li>
			    </ul>
</li>
			    </ul>

    
<!-- search script -->
<script type="text/javascript">
function submitQuickSearch(){
  concealContent();
  if($('#searchValue').val()!="") {
    $('#quickSearchForm').submit();
  }
}
</script>
<!-- end search script -->

<style type="text/css">
	#quickSearchForm .chosen-results {
		max-height: 500px;
	}
	#quickSearchForm .chosen-results li {
		padding-right: 20px;
		white-space: nowrap;
	}
	#quickSearchForm .chosen-container .chosen-drop {
		width: auto;
		min-width: 180px;
		max-width: 360px;
	}
    #quickSearchForm .chosen-container .chosen-drop .divider {
        padding: 0;
		overflow: hidden;
	}
</style>

<form id="quickSearchForm" method="post" action="/app/action/QuickSearchAction">
    <select id="stored-searches" data-placeholder="Stored Searches">
		<option></option>
		<optgroup>
            <option value="/app/template/XDATScreen_search_wizard1.vm">Advanced Search&hellip;</option>
		</optgroup>
        <optgroup class="stored-search-list">
			<option disabled>(no stored searches)</option>
			<!-- stored searches will show up here -->
		</optgroup>
	</select>
	<input id="searchValue" class="clean" name="searchValue" type="text" maxlength="40" size="20" value=""/>
    <button type="button" id="search_btn" class="btn2" onclick="submitQuickSearch();">Go</button>

    <script>

        (function(){
            var searchField = $('#searchValue');
            searchField.keyup(function( event ) {
              if (event.which == 13) {
                submitQuickSearch();
              }
            });
            
            searchField.each(function(){
                this.value = this.value || 'search';
                $(this).focus(function(){
                    $(this).removeClass('clean');
                    if (!this.value || this.value === 'search'){
                        this.value = '';
                    }
                })
            });

            var storedSearchMenu = $('#stored-searches');

            function compareSearches(a,b) {
                // sort alphabetically by the brief_description field, accounting for accented characters if necessary.
                return a.brief_description.localeCompare(b.brief_description);
            }

            XNAT.xhr.getJSON(XNAT.url.rootUrl('/data/search/saved'), function(data){

                var storedSearchesList = data.ResultSet.Result;
                storedSearchesList.sort(compareSearches);

                storedSearchMenu.find('optgroup.stored-search-list')
                        .empty()
                        .append(storedSearchesList.map(function(opt){
                            var val = serverRoot + '/app/template/Search.vm/node/ss.' + opt.id;
                            return '<option value="' + val + '">' + opt.brief_description + '</option>'
                        }).join(''));

                storedSearchMenu.on('change', function(){
                    window.location.href = this.value
                });

                storedSearchMenu.chosen({
                    width: '150px',
                    disable_search_threshold: 9,
                    inherit_select_classes: true,
                    placeholder_text_single: 'Stored Searches',
                    search_contains: true
                });

            });

        })();

    </script>
</form>


    </div>
</div>
<!-- /main_nav -->

<!-- main_nav interactions -->
<script type="text/javascript">

    jq(function(){

        var docBody         = jq(document.body);
        var mainNav         = jq('#main_nav').find('ul.nav');
        var mainNavBackdrop = jq('#main-nav-backdrop');

        function mainNavClose(e){
            mainNavBackdrop.hide();
            mainNav.find('.active').removeClass('active');
            mainNav.find('.open').hide().removeClass('open');
        }

        // give menus with submenus a class of 'more'
        mainNav.find('li ul, li li ul').closest('li').addClass('more');
        mainNav.find('li li ul').addClass('subnav');

        mainNav.on('click.nolink', 'a[href^="#"]', function(e){
            e.preventDefault();
        });

        mainNav.on('click.topnav', '> li', function(e){
            e.stopPropagation();

            var topMenuItem  = jq(this);
            var subMenu      = topMenuItem.find('> ul');
            var subMenuItems = null;

            mainNavBackdrop.show();

            // deactive all top-level items
            mainNav.find('> li').removeClass('active');
            // activate only this one
            topMenuItem.addClass('active');

            subMenuItems = subMenu.find('> li.more').removeClass('active');
            subMenuItems.off('click.subnav').on('click.subnav', function(e){
                e.stopPropagation();
                subMenuItems.removeClass('active');
                var thisMenuItem = jq(this);
                thisMenuItem.addClass('active')
                            .find('> ul')
                            .each(function(){
                                var sub     = jq(this);
                                var offsetL = sub.closest('li').width();
                                sub.css({ 'left': offsetL });
                            });
            });

        });

        mainNav.on('click', 'a', function(e){
            var href = $(this).attr('href');
            if (href.indexOf('#') !== 0) {
                mainNavClose.call(this, e)
            }
        });
        mainNavBackdrop.on('click', mainNavClose);

        // clicking the "Logout" link sets the warning bar cookie to 'OPEN' so it's available if needed on next login
        jq('#logout_user').click(function(){
            XNAT.cookie.set('WARNING_BAR', 'OPEN');
            XNAT.cookie.set('NOTIFICATION_MESSAGE', 'OPEN');
        });

    });

</script>
<!-- end main_nav interactions -->

<div id="page_wrapper">

<div id="header" class="main_header"><div class="pad">

    
    <a id="header_logo" href="/app/template/Index.vm" style="display:none;">
        

<img class="logo_img" src="/images/logo.png" style="border:none;">
    </a>

</div></div>  <!-- /header -->


<script type="text/javascript">

    XNAT.app.adjustHeaderAndNavForLogoSize = function(){

        var header_logo$ = jq('#header_logo');

        // adjust height of header if logo is taller than 65px
        var hdr_logo_height = header_logo$.height();
        if (hdr_logo_height > 65) {
            jq('.main_header').height(hdr_logo_height + 10);
        }

                                                
        //
        //var recent_proj_height = jq('#min_projects_list > div').height();
        var recent_proj_height = 67;
        //jq('#min_projects_list, #min_expt_list').height(recent_proj_height * 5).css({'min-width':349,'overflow-y':'scroll'});

    }

    // initialize the advanced search method toggler
    XNAT.app.searchMethodToggler = function(_parent){

        _parent = $$(_parent||'body');

        var INPUTS = 'input, select, textarea, :input',
            SEARCH_METHOD_CKBOXES = 'input.search-method',
            __searchGroups = _parent.find('div.search-group'),
            __searchMethodInputs = _parent.find(SEARCH_METHOD_CKBOXES);

        // disable 'by-id' search groups by default
        __searchGroups.filter('.by-id').addClass('disabled').
            find(INPUTS).not(SEARCH_METHOD_CKBOXES).changeVal('').prop('disabled', true).addClass('disabled');

        // enable 'by-criteria' search groups by default
        __searchGroups.filter('.by-criteria').removeClass('disabled').
            find(INPUTS).prop('disabled',false).removeClass('disabled');

        // check 'by-criteria' checkboxes
        __searchMethodInputs.filter('.by-criteria').prop('checked', true);

        // don't add multiple click handlers
        __searchMethodInputs.off('click');

        // toggle the search groups
        __searchMethodInputs.on('click', function(){

            var method = this.value,
                isChecked = this.checked;

            __searchGroups.addClass('disabled').
                find(INPUTS).not(SEARCH_METHOD_CKBOXES).changeVal('').prop('disabled', true).addClass('disabled');

            __searchGroups.filter('.' + method).removeClass('disabled').
                find(INPUTS).prop('disabled', false).removeClass('disabled');

            // update the radio buttons/checkboxes
            __searchMethodInputs.prop('checked',false);
            __searchMethodInputs.filter('.' + method).prop('checked', true);
            menuUpdate();
        });
    };

</script>
<script>
    window.loggedIn = true;
</script>
<script src="/scripts/xnat/app/sessionTimer.js"></script>


    <div id="tp_fm"></div>

<!-- END: xnat-templates/navigations/DefaultTop.vm -->

                        <!-- /xnat-templates/navigations/DefaultLeft.vm -->

<!-- BEGIN xnat-templates/navigations/LeftBarOptions.vm -->
<!-- END xnat-templates/navigations/LeftBarOptions.vm -->



<div id="l_tv" style="display:none;"></div>


<script type="text/javascript">
    //build element_array
    var lTV = new LeftBarTreeView({treeview: "l_tv"});

    lTV.loadNodeData = function( node, fnLoadComplete ){
        var tabReqObject = node.data;
        tabReqObject.label = node.label;
        tabReqObject.node = node;
        if (tabReqObject.URL != undefined) {
            window.location = serverRoot + "/app/template/Search.vm/node/" + tabReqObject.ID;
        }
        else {
            if (tabReqObject.ID != undefined && tabReqObject.ID == "ss") {
                var callback = {
                    cache: false, // Turn off caching for IE
                    success: function( oResponse ){
                        var oResults = eval("(" + oResponse.responseText + ")");
                        if ((oResults.ResultSet.Result) && (oResults.ResultSet.Result.length)) {
                            for ( var ssC = 0; ssC < oResults.ResultSet.Result.length; ssC++ ) {
                                var cpNode = new YAHOO.widget.TextNode({
                                    label: oResults.ResultSet.Result[ssC].brief_description,
                                    ID: "ss." + oResults.ResultSet.Result[ssC].id,
                                    SS_ID: oResults.ResultSet.Result[ssC].id,
                                    URL: serverRoot + '/REST/search/saved/' + oResults.ResultSet.Result[ssC].id + '',
                                    TITLE: oResults.ResultSet.Result[ssC].description
                                }, oResponse.argument.node, false);
                            }
                        }
                        oResponse.argument.fnLoadComplete();
                    },
                    failure: function( oResponse ){
                        oResponse.argument.fnLoadComplete();
                    },
                    argument: {"node": node, "fnLoadComplete": fnLoadComplete}
                };

                //YAHOO.util.Connect.asyncRequest('GET',this.obj.URL,this.initCallback,null,this);
                YAHOO.util.Connect.asyncRequest('GET', serverRoot + '/REST/search/saved?XNAT_CSRF=' + window.csrfToken + '&format=json&stamp=' + (new Date()).getTime(), callback, null);
            }
            else {
                fnLoadComplete();
            }
        }
    }

    lTV.init();

</script>
<!-- end /xnat-templates/navigations/DefaultLeft.vm -->

                    

<div id="breadcrumbs"></div>
<script src="/scripts/xnat/ui/breadcrumbs.js"></script>
<script language="javascript">

    window.isProjectPage = (XNAT.data.context.xsiType === 'xnat:projectData');

    // wrap it up to keep things
    // out of global scope
    (function(){

        var crumbs = [];

        
        
                                    //HAS OM
                                    //experimentData
                                                                                                                // 367
                            // prevent 'bonus' breadcrumb on project page
                            if (!window.isProjectPage){
                                crumbs.push({
                                    id:    'roosopt',
                                    link:  null,
                                    label: 'roosopt'
                                });
                            }
                                            
                                                    

        XNAT.ui.breadcrumbs.render('#breadcrumbs', crumbs);


    })();

</script>

            <div id="layout_content2" style="display:none;">Loading...</div>
            <div id="layout_content">
                <!--BEGIN SCREEN CONTENT -->
                <script language="javascript">
    var server = "/images/";
    var user_email = "grayjoh@nyspi.columbia.edu";
</script>
<div id="project-page" class="yui-skin-sam" style="position: relative;">

    		    		
    <h2 class="edit_header1" style="">OPTIMUM</h2>
            <script type="text/javascript" src="/scripts/yui/build/resize/resize-beta-min.js"></script>
        <script type="text/javascript" src="/scripts/yui/build/layout/layout-beta-min.js"></script>
        <script type="text/javascript" src="/scripts/generated/xdat_stored_search.js"></script>
        <script type="text/javascript" src="/scripts/generated/xdat_search_field.js"></script>
        <script type="text/javascript" src="/scripts/generated/xdat_criteria.js"></script>
        <script type="text/javascript" src="/scripts/generated/xdat_criteria_set.js"></script>
        <script type="text/javascript" src="/scripts/search/csTabManager.js"></script>
        <script type="text/javascript" src="/scripts/search/saveSearch.js"></script>
        <script type="text/javascript" src="/scripts/search/searchManager.js"></script>
        <script type="text/javascript" src="/scripts/search/csDataTableSearch.js"></script>
        <script type="text/javascript" src="/scripts/search/csDataTableStoredSearch.js"></script>
        <script type="text/javascript" src="/scripts/yui/xnat_loader.js"></script>
        <!-- BEGIN SET AND PARSE SUMMARY TABS -->
        		        <!-- BEGIN xnat-templates/screens/xnat_projectData/xnat_projectData_summary_tabs.vm -->
<div ID="project_summary_module" style="display:none">
    <div id="projectSummary" class="yui-navset">
        <ul class="yui-nav">
            <li class="selected"><a href="#tab1"><em>Details</em></a></li>
                                    
        </ul>
        <div class="yui-content">
            <div id="tab1" class="pad10">
                <p>
<table>
    <tr>
        <th align="left">ID:</th>
        <td>roosopt
                    </td>
    </tr>
            <tr>
            <th align="left" valign="top">Description:</th>
            <td>
                                    Optimizing Outcomes of Treatment-Resistant Depression in Older Adults
                            </td>
        </tr>
                <tr>
            <th align="left">Keywords:</th>
            <td>7409
            </td>
        </tr>
                <tr>
            <th align="left">PI:</th>
            <td>Roose, Steven
            </td>
        </tr>
        </table>
</p>
            </div>

                        
        </div>
    </div>
</div>

<script type="text/javascript">
    function summaryIndexChanged(){
        var activeIndex = this.get("activeIndex");
        YAHOO.util.Cookie.set("roosopt.summary.index", activeIndex);
    }

    function summaryTabManagerInit(){
        window.summaryTabView = new YAHOO.widget.TabView('projectSummary');
        var oButton1 = new YAHOO.widget.Button("button1");
        var oButton2 = new YAHOO.widget.Button("button2");
        

        window.project_summary_module = new YAHOO.widget.Module("project_summary_module", {
            visible: false,
            zIndex: 5
        });

        		
        window.project_summary_module.show();

                                    var tabIndex = YAHOO.util.Cookie.get("roosopt.summary.index");
                window.summaryTabView.set('activeIndex', tabIndex || 0);
                        window.summaryTabView.subscribe("activeTabChange", summaryIndexChanged);
        
    }
    summaryTabManagerInit();
</script>
<!-- END xnat-templates/screens/xnat_projectData/xnat_projectData_summary_tabs.vm -->
        <!-- END SET AND PARSE SUMMARY TABS -->


                                                                                                                                                                                                                    <!-- actions menu -->
<DIV id="actionsMenu" class="yuimenu">
<DIV class="bd">
    <ul class="first-of-type">
        <li class="yuimenuitem">
            <a class="yuimenuitemlabel">Actions</a>
        </li>
    </ul>
<ul>

    								








<!-- Sequence: 5 -->


<!-- xnat_projectData/actionsBox/Add -->

									<!-- Sequence: 10 -->

<li class="yuimenuitem">
    <a id="favorite_a" class="yuimenuitemlabel" href="#"></a>
</li>

<script type="text/javascript">

    XNAT.projectPage =
            getObject(XNAT.projectPage||{});

    XNAT.projectPage.actionsMenu =
            getObject(XNAT.projectPage.actionsMenu||{});

    (function(){

        var actionsMenu = XNAT.projectPage.actionsMenu,
            _faveLink = document.getElementById('favorite_a'),
            ADD_FAVE = 'Add to Favorites',
            REMOVE_FAVE = 'Remove from Favorites',
            faveText = ADD_FAVE,
            faveStatus = false;

        
        _faveLink.innerHTML = faveText;

        jq(_faveLink).click(function( e ){

            e.preventDefault();

            function quickMsg( text ){
                XNAT.ui.banner.top(2000, text, 'success')
            }

            var method,
                url = XNAT.url.csrfUrl('/data/users/favorites/Project/roosopt'),
                callback = {
                    error: function(){
                        xmodal.message('Error', 'An error occurred changing favorite status.')
                    }
                };

            if (faveStatus === true) {
                method = 'DELETE';
                callback.success = function(){
                    quickMsg('Project removed from favorites');
                    _faveLink.innerHTML = ADD_FAVE;
                    faveStatus = false;
                }
            }
            else {
                method = 'PUT';
                callback.success = function(){
                    quickMsg('Project added to favorites.');
                    _faveLink.innerHTML = REMOVE_FAVE;
                    faveStatus = true;
                }
            }

            XNAT.xhr.requestOfType(method, url, callback);

        });

    })();

</script>									<!-- Sequence: 15 -->
<!-- allowGuest: true -->

	           <li class="yuimenuitem">
            <a class="yuimenuitemlabel" href="/app/action/XDATActionRouter/xdataction/xml_file/search_element/xnat%3AprojectData/search_field/xnat%3AprojectData.ID/search_value/roosopt/popup/false">Download XML</A>
           </li>									<!-- Sequence: 20 -->
<!-- allowGuest: true -->

   <li class="yuimenuitem">
    <a class="yuimenuitemlabel" href="/app/action/ProjectDownloadAction/project/roosopt">Download Images</A>
   </li>									

																		
<!-- BEGIN xnat-templates/screens/xnat_projectData/actionsBox/ManageFiles.vm -->
     <li class="yuimenuitem">
			<A href="" ONCLICK="window.viewer.render();return false;">
				<div class="ic">
					<img border="0" src="/scripts/yui/build/treeview/assets/img/folders/cf.gif"/>
				</div>
				<div class="ic_spacer">&nbsp;</div>
				Manage Files
			</A>
	 </li>

<script type="text/javascript" src="/scripts/FileViewer.js"></script>
<script type="text/javascript">
  	var obj=new Object();
  	obj.uri=serverRoot + "/REST/projects/roosopt";
    obj.refresh = serverRoot + "/data/services/refresh/catalog?options=" + encodeURIComponent("populateStats,append,delete,checksum") + "&XNAT_CSRF=" + csrfToken + "&resource=/archive/projects/roosopt";
    obj.objectId = "roosopt";
    obj.objectType = "project";

    	      obj.canEdit=false;
	              obj.canDelete=false;
    
  obj.catalogs=new Object();
  obj.catalogs.ids=new Array();
  window.viewer=new FileViewer(obj);
    
  function showFiles(){
    window.viewer.render();
  }
</script>
<style type="text/css">   
	/* custom styles for inline instances */
.yui-skin-sam .yui-ac-input { position:static;width:20em; vertical-align:middle;}
.yui-skin-sam .yui-ac-container { width:20em;left:0px;}

/* buttons */
.yui-ac .yui-button {vertical-align:middle;}
.yui-ac .yui-button button {background: url(/scripts/yui/build/autocomplete/assets/img/ac-arrow-rt.png) center center no-repeat }
.yui-ac .open .yui-button button {background: url(/scripts/yui/build/autocomplete/assets/img/ac-arrow-dn.png) center center no-repeat}

/* custom styles for scrolling container */ 
	#type_auto_div { 
    padding-bottom:2em; 
	}
	#type_auto_div .yui-ac-content { 
    max-height:20em;overflow:auto;overflow-x:hidden; /* set scrolling */ 
    _height:20em; /* ie6 */ 
	} 
	
  .icon-of { display:block; height: 19px; padding-left: 20px; background: transparent url(/scripts/yui/build/treeview/assets/img/folders/of.gif) no-repeat;}
  .icon-f { display:block; font-size:11px; height: 17px; padding-left: 4px;}
  .icon-cf { display:block; height: 19px; padding-left: 20px; background: transparent url(/scripts/yui/build/treeview/assets/img/folders/cf.gif) no-repeat;} 
  .ygtvcheck0 { background: url(/scripts/yui/build/treeview/assets/img/check/check0.gif) 0 0 no-repeat; width:16px; cursor:pointer }
  .ygtvcheck1 { background: url(/scripts/yui/build/treeview/assets/img/check/check1.gif) 0 0 no-repeat; width:16px; cursor:pointer }
  .ygtvcheck2 { background: url(/scripts/yui/build/treeview/assets/img/check/check2.gif) 0 0 no-repeat; width:16px; cursor:pointer }
</style>
<!-- END xnat-templates/screens/xnat_projectData/actionsBox/ManageFiles.vm -->
																														</ul>
</DIV>
</DIV>
<SCRIPT>
    YAHOO.util.Event.onContentReady("actionsMenu", function(){
        var actionsMenu = new YAHOO.widget.Menu("actionsMenu", {
            autosubmenudisplay: true,
            scrollincrement: 5,
            position: "static",
            maxheight: 150,
            submenualignment: ["tr","br"] // aligns top-right (tr) corner of submenu to bottom-right (br) corner of parent item
        });
        // Render the MenuBar instance
        actionsMenu.getItem(0).cfg.setProperty("disabled", true);
        actionsMenu.render();
    });
</SCRIPT>

        <div class="clear"></div>
        <br>

        		
        <div id="paginator"></div>
<BR>
<div id="tab_module">
    <div class="bd">
        <div id="search_tabs"></div>
    </div>
</div>

<script type="text/javascript">
    var stored_searches = new Array();
                        stored_searches.push({
            ID: "@xnat:subjectData",
            label: "Subjects",
            URL: serverRoot + "/REST/projects/roosopt/searches/@xnat:subjectData"
        });
                                        stored_searches.push({
            ID: "@xnat:mrSessionData",
            label: "MR Sessions",
            URL: serverRoot + "/REST/projects/roosopt/searches/@xnat:mrSessionData"
        });
                    
    var url = "/servlet/AjaxServlet";
    url = url + "";

    var currentTime = new Date();
    var pageID = currentTime.getTime() + '_';


    function openTabsChange(obj){
        YAHOO.util.Cookie.remove("roosopt.open_bundle.tabs");
        var bundles = this.loaded.toString();
        YAHOO.util.Cookie.set("roosopt.open_bundle.tabs", bundles, { expires: new Date("January 12, 2025") });
        //alert(bundles + ":" +YAHOO.util.Cookie.get("roosopt.open_bundle.tabs"));
        //wrangleTabs({
        //    wrapper: '#search_tabs', // selector for element where tabs will be rendered by YUI - use 'body' to hit all tab sets
        //    force: true // do we show it even if the tabs aren't too wide?
        //});
        //wrangleTabs('#search_tabs');
        //console.debug('openTabsChange('+obj+')');
    }

    function TabManagerInit(){

        var tab_module = new YAHOO.widget.Module("tab_module", { visible: true });

        window.tab_manager = new TabManager();

        window.tab_manager.setCsrfToken("ce758b23-a810-4592-aba2-0ea568f08e47");

        window.tab_manager.init(stored_searches);

                            window.tab_manager.load({ID:'@xnat:subjectData'});
        
        var bundles = YAHOO.util.Cookie.get("roosopt.open_bundle.tabs");
        if (bundles !== null && bundles.length > 0) {
            var open_tab_array = bundles.split(',');
            for (var open_tab_counter = 0; open_tab_counter < open_tab_array.length; open_tab_counter++) {
                var open_tab = open_tab_array[open_tab_counter];
                window.tab_manager.load({ ID: open_tab });
            }
        }
        else if ('@xnat:subjectData') {
            window.tab_manager.load({ ID: '@xnat:subjectData' });
        }

        var bundleTabIndex = YAHOO.util.Cookie.get("roosopt.open_bundle.index");
        if (bundleTabIndex != null) {
            window.tab_manager.setActiveTab(parseInt(bundleTabIndex));
            //window.tab_manager.tabView.set('activeIndex',parseInt(bundleTabIndex));
        }

        window.tab_manager.onOpenTabsChange.subscribe(bundleTabChange, this);
        window.tab_manager.onOpenTabsChange.subscribe(openTabsChange, window.tab_manager);

        //console.debug('TabManagerInit()');

    }

    function debug_out(msg){
        var div = document.getElementById("mylogger");
        if (div != undefined && div != null) {
            div.innerHTML += msg + "<br/>";
        }
    }

    YAHOO.util.Event.onDOMReady(TabManagerInit);

    function bundleTabChange(obj){
        var activeIndex = this.get("activeIndex");
        YAHOO.util.Cookie.set("roosopt.open_bundle.index", activeIndex);
    }

    function addBundleMonitor(){
        window.tab_manager.tabView.subscribe("activeTabChange", bundleTabChange);
    }

    YAHOO.util.Event.onDOMReady(addBundleMonitor);

    jq(window).load(function(){
        // if the 'phantom'/'disabled' tab is there, wrangle the tabs
        if (!jq('#search_tabs').find('li').not('.disabled').length) {
            wrangleTabs('#search_tabs', true);
        }
    });

</script>

        								<!-- injected content -->
<script src="/scripts/xnat/plugin/containerService/projectSearchLauncher.js"></script>
<script src="/scripts/xnat/plugin/scanTable/selectableTableBehavior.js"></script>
			        <DIV ID="temp_display"></DIV>
</div>

                <!--END SCREEN CONTENT -->
            </div>
            
<div id="mylogger"></div>

		


<!-- path: xnat-templates/navigations/htmlClose -->
</div><!-- /page_wrapper -->

<div class="clear"></div>
<div id="xnat_power">
    </div>


<script type="text/javascript" src="/scripts/footer.js"></script>
</body>
</html>
